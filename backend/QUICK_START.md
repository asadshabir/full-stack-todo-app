# TaskFlow 3D Backend - Quick Start Guide

## Installation (5 minutes)

### Step 1: Navigate to Backend Directory

```bash
cd backend
```

### Step 2: Run Setup Script

```bash
python setup.py
```

This will:
- Create `.env` file with auto-generated JWT secret
- Show next steps for database configuration

### Step 3: Add Database Connection

1. Get your Neon PostgreSQL connection string from [neon.tech](https://neon.tech)
2. Open `.env` file
3. Replace the `DATABASE_URL` value with your connection string:

```env
DATABASE_URL=postgresql://user:password@ep-your-endpoint.region.aws.neon.tech/yourdb?sslmode=require
```

### Step 4: Install Dependencies

```bash
# Create virtual environment (recommended)
python -m venv venv

# Activate it
# Windows:
venv\Scripts\activate
# macOS/Linux:
source venv/bin/activate

# Install packages
pip install -r requirements.txt
```

### Step 5: Run the Server

```bash
python main.py
```

You should see:
```
ðŸš€ Starting TaskFlow 3D API...
ðŸ“Š Creating database tables...
âœ… Database tables created successfully
âœ… Database connection successful
INFO:     Uvicorn running on http://0.0.0.0:8000
```

### Step 6: Test the API

Open your browser and visit:
- **Interactive Docs**: http://localhost:8000/docs
- **API Status**: http://localhost:8000/
- **Health Check**: http://localhost:8000/health

## Testing with curl

### 1. Create an account

```bash
curl -X POST http://localhost:8000/api/auth/signup \
  -H "Content-Type: application/json" \
  -d "{\"email\":\"test@example.com\",\"password\":\"test123\",\"name\":\"Test User\"}"
```

Save the `access_token` from the response.

### 2. Create a todo

Replace `YOUR_TOKEN` with the token from step 1:

```bash
curl -X POST http://localhost:8000/api/todos \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -d "{\"title\":\"My first todo\",\"priority\":\"high\",\"category\":\"work\"}"
```

### 3. Get all todos

```bash
curl http://localhost:8000/api/todos \
  -H "Authorization: Bearer YOUR_TOKEN"
```

## Testing with Python

Run the included test script:

```bash
python test_api.py
```

This will automatically test all endpoints.

## Common Issues

### "DATABASE_URL not set"

**Problem**: `.env` file missing or DATABASE_URL not configured

**Solution**:
```bash
# Run setup script
python setup.py

# Then edit .env and add your Neon connection string
```

### "Module not found" errors

**Problem**: Dependencies not installed

**Solution**:
```bash
pip install -r requirements.txt
```

### CORS errors from frontend

**Problem**: Frontend URL not in CORS_ORIGINS

**Solution**: Edit `.env` and add your frontend URL:
```env
CORS_ORIGINS=http://localhost:3000,http://localhost:3001
```

### Database connection timeout

**Problem**: Neon database connection string incorrect

**Solution**:
1. Verify connection string format includes `?sslmode=require`
2. Check Neon dashboard for correct endpoint
3. Ensure database is not paused (Neon auto-pauses inactive databases)

## Environment Variables Reference

```env
# Required
DATABASE_URL=postgresql://...              # Neon PostgreSQL connection string
JWT_SECRET_KEY=...                         # Auto-generated by setup.py

# Optional (have sensible defaults)
JWT_ALGORITHM=HS256                        # JWT signing algorithm
JWT_EXPIRATION_HOURS=24                    # Token expiration
CORS_ORIGINS=http://localhost:3000         # Allowed origins (comma-separated)
PORT=8000                                  # Server port
```

## Project Structure

```
backend/
â”œâ”€â”€ main.py                 # FastAPI app (START HERE)
â”œâ”€â”€ models/                 # Database models
â”‚   â”œâ”€â”€ user.py            # User model
â”‚   â””â”€â”€ todo.py            # Todo model
â”œâ”€â”€ schemas/               # Request/Response schemas
â”‚   â”œâ”€â”€ user.py            # User schemas
â”‚   â””â”€â”€ todo.py            # Todo schemas
â”œâ”€â”€ routes/                # API endpoints
â”‚   â”œâ”€â”€ auth.py            # /api/auth/* endpoints
â”‚   â””â”€â”€ todos.py           # /api/todos/* endpoints
â”œâ”€â”€ utils/                 # Utilities
â”‚   â”œâ”€â”€ auth.py            # JWT & password hashing
â”‚   â””â”€â”€ database.py        # Database connection
â”œâ”€â”€ middleware/            # Middleware
â”‚   â””â”€â”€ auth.py            # JWT verification
â”œâ”€â”€ .env                   # Environment variables (created by setup.py)
â”œâ”€â”€ requirements.txt       # Python dependencies
â””â”€â”€ README.md             # Full documentation
```

## API Endpoints Cheat Sheet

### Authentication (no auth required)

```bash
POST /api/auth/signup      # Create account
POST /api/auth/signin      # Login
```

### Authentication (auth required)

```bash
GET  /api/auth/me          # Get current user
POST /api/auth/signout     # Logout
```

### Todos (all require auth)

```bash
GET    /api/todos               # List all todos (with filters)
POST   /api/todos               # Create todo
GET    /api/todos/{id}          # Get single todo
PUT    /api/todos/{id}          # Update todo
DELETE /api/todos/{id}          # Delete todo
PATCH  /api/todos/{id}/toggle   # Toggle completion
```

### Query Parameters for GET /api/todos

```bash
?completed=true              # Filter by completion
?priority=high               # Filter by priority (low/medium/high)
?category=work               # Filter by category
?status=in-progress          # Filter by status (pending/in-progress/completed)
?search=meeting              # Search in title/description
?sort_by=due_date            # Sort by field
?sort_order=asc              # Sort direction (asc/desc)
```

## Next Steps

1. âœ… Server running? Test at http://localhost:8000/docs
2. âœ… Create a user account via `/api/auth/signup`
3. âœ… Get a JWT token
4. âœ… Create some todos
5. âœ… Connect your Next.js frontend

## Need Help?

- **Full Documentation**: See `README.md`
- **Interactive API Docs**: http://localhost:8000/docs
- **Health Check**: http://localhost:8000/health
- **Test Script**: Run `python test_api.py`

Happy coding!
